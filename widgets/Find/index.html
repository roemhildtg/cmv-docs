<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://cmv.io/widgets/Find/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Find - CMV</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">CMV</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../..">Introduction</a>
</li>

                    
                        
<li >
    <a href="../../installation/">Installation</a>
</li>

                    
                        
<li >
    <a href="../../configure/">Configure</a>
</li>

                    
                        
<li >
    <a href="../../support/">Support</a>
</li>

                    
                        
<li >
    <a href="../../develop/">Development Environment</a>
</li>

                    
                        
<li >
    <a href="../../CHANGELOG/">Changelog</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Configure <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../configure/">Introduction</a>
</li>

                    
                        
<li >
    <a href="../../configure/viewer/">viewer.js</a>
</li>

                    
                        
<li >
    <a href="../../configure/app/">app.js</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Viewer.js <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../configure/header/">header</a>
</li>

                    
                        
<li >
    <a href="../../configure/mapOptions/">MapOptions</a>
</li>

                    
                        
<li >
    <a href="../../configure/operationalLayers/">Operational Layers</a>
</li>

                    
                        
<li >
    <a href="../../configure/panes/">Panes</a>
</li>

                    
                        
<li >
    <a href="../../configure/titles/">Titles</a>
</li>

                    
                        
<li >
    <a href="../../configure/widgets/">Widgets</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Widgets <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../">Introduction</a>
</li>

                    
                        
<li >
    <a href="../Basemaps/">BaseMaps</a>
</li>

                    
                        
<li >
    <a href="../Bookmarks/">Bookmarks</a>
</li>

                    
                        
<li >
    <a href="../Directions/">Directions</a>
</li>

                    
                        
<li >
    <a href="../Draw/">Draw</a>
</li>

                    
                        
<li >
    <a href="../Editor/">Editor</a>
</li>

                    
                        
<li class="active">
    <a href="./">Find</a>
</li>

                    
                        
<li >
    <a href="../Geocoder/">Geocoder</a>
</li>

                    
                        
<li >
    <a href="../Growler/">Growler</a>
</li>

                    
                        
<li >
    <a href="../Help/">Help</a>
</li>

                    
                        
<li >
    <a href="../HomeButton/">Home Button</a>
</li>

                    
                        
<li >
    <a href="../Identify/">Identify</a>
</li>

                    
                        
<li >
    <a href="../LayerControl/">Layer Control</a>
</li>

                    
                        
<li >
    <a href="../Legend/">Legend</a>
</li>

                    
                        
<li >
    <a href="../LocateButton/">Locate Button</a>
</li>

                    
                        
<li >
    <a href="../MapInfo/">Map Info</a>
</li>

                    
                        
<li >
    <a href="../Measurement/">Measurement</a>
</li>

                    
                        
<li >
    <a href="../OverviewMap/">Overview Map</a>
</li>

                    
                        
<li >
    <a href="../Print/">Print</a>
</li>

                    
                        
<li >
    <a href="../Scalebar/">Scalebar</a>
</li>

                    
                        
<li >
    <a href="../StreetView/">StreetView</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../contribute/">Introduction</a>
</li>

                    
                        
<li >
    <a href="../../contribute/BuildingCustomWidgets/">Building Custom Widgets</a>
</li>

                    
                        
<li >
    <a href="../../contribute/ContributingOnGitHub/">Submitting a Pull Request</a>
</li>

                    
                        
<li >
    <a href="../../contribute/Committers/">Committing Changes to CMV</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../about/license/">License</a>
</li>

                    
                        
<li >
    <a href="../../about/changelog/">Change Log</a>
</li>

                    
                        
<li >
    <a href="../../about/team/">The CMV Team</a>
</li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li >
                    <a rel="next" href="../Editor/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../Geocoder/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/cmv/cmv-app">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#find">Find</a></li>
        
            <li><a href="#features">Features</a></li>
        
            <li><a href="#important-concepts">Important concepts</a></li>
        
            <li><a href="#tips">Tips</a></li>
        
            <li><a href="#specifying-columns">Specifying columns</a></li>
        
            <li><a href="#prompt">Prompt</a></li>
        
            <li><a href="#selection-mode">Selection mode</a></li>
        
            <li><a href="#symbology">Symbology</a></li>
        
            <li><a href="#custom-grid-event-functions">Custom grid event functions</a></li>
        
            <li><a href="#example-config-object">Example Config Object</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="find">Find</h1>
<p>The Find widget allows you to configure multiple searches against an ArcGiS map service.  These searches can be conducted on:</p>
<ul>
<li>a single field of a single layer</li>
<li>many fields of a single layer</li>
<li>or on many fields of many layers</li>
</ul>
<h2 id="features">Features</h2>
<ul>
<li>Configurable columns for each query</li>
<li>Configurable sort for each query</li>
<li>Configurable prompt for each query</li>
<li>Configurable symbology, both the base symbology used to show each find result on the map as well as a different symbology for the selected find result(s)</li>
<li>Configurable zoom extent scale factor - this will be used to expand the extent when setting extent on the map.</li>
<li>Options for controlling FindTask's exact match option and how zoom is handled when selecting results in the result list.</li>
</ul>
<h2 id="important-concepts">Important concepts</h2>
<p>When configuring the various options, it's important to remember that the widget is based on the <a href="https://developers.arcgis.com/javascript/jsapi/findtask-amd.html">FindTask</a> and all results will be a FindResult object.  A FindResult object will contain a <code>feature</code> attribute which is a Graphic object.  This means it will have an <code>attributes</code> object with the properties of each result as specified by the layer in the base service.</p>
<p>It is important to recognize that the attribute names in this <code>attributes</code> property will be the field aliases specified for each field in the service definition and not the actual field name.</p>
<p>It is also important to understand that different layers in a map service can have very different attributes but the grid columns you specify apply to all layers included in the search.  It is therefore recommended to achieve best results that you either limit the layers included in each search to layers that have similar attributes <em>or</em>, limit the columns you specify to fields shared by all layers in a search.</p>
<h2 id="tips">Tips</h2>
<p>If you can control the service, it may be useful to use common aliases for fields in different layers.  For example:</p>
<ul>
<li>PDNAME -&gt; Name</li>
<li>FDNAME -&gt; Name</li>
<li>RESNAME -&gt; Name</li>
</ul>
<p>You can also use a <code>get</code> function (detailed below) to compute and store a value on each FindResult item in your results.  A get function will be invoked and passed the FindResult object.  You can test for different properties to format the returned string.</p>
<h2 id="specifying-columns">Specifying columns</h2>
<p>There are two ways to specify columns.  Each has it's own benefits but follows the rules outlined in the <a href="https://github.com/SitePen/dgrid/blob/v0.3.15/doc/components/core-components/Grid.md#specifying-grid-columns">dgrid documentation</a> for specifying grid structures.</p>
<p>Using an the array approach gives more flexibility but the object form is a handy shortcut for simple configurations.</p>
<h3 id="as-an-array-of-objects">As an array of objects</h3>
<p>Add a <code>gridColumns</code> property to the search object.  The value should be an array of objects with the following properties:</p>
<ul>
<li><code>field</code>: this is the field alias of the column to get the value from.</li>
<li><code>get</code>: this should be a function that accepts a find result item as the only argument and returns a string to display.</li>
<li><code>label</code>: The column heading</li>
<li><code>resizable</code> <true/false>: whether or not the column can be resized</li>
<li><code>visible</code> <true/false>: set to false to compute and store a value on each FindResult item without displaying it in a column.  This is useful for sorting.</li>
<li><code>width</code>: initial width of the column</li>
</ul>
<h3 id="as-an-object">As an object</h3>
<p>This is a handy shortcut for specifying column defininitons but is much less flexible.  Check the dgrid documentation for details.</p>
<p>Another way to specify a column is to use the get function.  Using this approach, the underlying dgrid instance will call the function you specify as the <code>get</code> property of a column object.  This function will receive the FindResult object and should return a string.  Check the Dgrid documentation for more information.</p>
<p>You can specify a visible property for each property.  Setting this to false is a useful way of computing and storing a property which can be specified as a attribute to sort on but will not be shown in the grid:</p>
<h4 id="get-function">Get Function</h4>
<p>The get function can be used to compute and return a string to display in a column or use as a sort attribute.  The partial example below uses a get function to to create a column that is not displayed in the grid but is used to sort the results.</p>
<pre><code>gridColumns: [
    { field: 'SORT_VAL', visible: false, get: function ( item ) {
        return String( '0000' + item.feature.attributes.ASSET_NO ).slice( -4 );
    } }
],
sort: [
    {
        attribute: 'SORT_VAL',
        descending: false
    }
]
</code></pre>

<h2 id="prompt">Prompt</h2>
<p>You can add a <code>prompt</code> property to each query object to set the placeholder or prompt text in the search input for the query.</p>
<h2 id="selection-mode">Selection mode</h2>
<p>You can add a <code>selectionMode</code> property to control what results users can select in the results grid.  You need to specify any of the dgrid Selection mixin modes.</p>
<p>You can set this both for all queries (specify as a sibling of the <code>queries</code> property and optionally override for each query</p>
<h2 id="symbology">Symbology</h2>
<p>You can add a <code>resultsSymbols</code> property to override the default symbology of each FindResult.  You can also add a <code>selectedSymbols</code> property to override the symbology used to depict selected find results in the map.</p>
<p>Each is an object with</p>
<ul>
<li>point</li>
<li>polygon</li>
<li>polyline</li>
</ul>
<p>properties.  Each of which must be a fully formed JSON symbol definition appropriate to the geometry type.  Check viewer.js for examples.</p>
<h2 id="custom-grid-event-functions">Custom grid event functions</h2>
<p>You can add custom handlers for dgrid events by adding a <code>customGridHandlers</code> property which should be an array of objects:</p>
<pre><code>customGridHandlers: [
  {
    event: '.dgrid-row:click',
    handler: function ( event ) {}
  }
]
</code></pre>

<h2 id="example-config-object">Example Config Object</h2>
<pre><code>find: {
    include: true,
    id: 'find',
    type: 'titlePane',
    path: 'gis/dijit/Find',
    title: 'Find',
    open: false,
    position: 8,
    options: {
    map: true,
        queries: [
            {
                description: 'Buildings',
                url: 'https://localhost/arcgis/rest/services/Buildings/MapServer',
                layerIds: [ 0 ],
                searchFields: [ 'BUILDING', 'NAME' ],
                minChars: 2,
                prompt: 'Bldg# or name',
                gridColumns: [
                    { field: 'BUILDING', label: 'Building', resizable: false, width: 75, visible: true },
                    { field: 'NAME', label: 'Name', visible: true, get: function ( result ) {
                        var name = result.feature.attributes.NAME;
                        if ( result.feature.attributes.STATUS !== 'ACTIVE' ) {
                            name += ' ( ' + result.feature.attributes.STATUS + ' )';
                        }
                        return name;
                    } }
                ],
                sort: [
                    {
                        attribute: 'BUILDING',
                        descending: false
                    }
                ]
            },
            {
                description: 'Building Entrances',
                url: 'https://localhost/arcgis/rest/services/BuildingEntrances/MapServer',
                layerIds: [ 0 ],
                searchFields: [ 'BUILDING_DOOR_SEARCH' ],
                minChars: 2,
                prompt: 'Bldg# Door#',
                gridColumns: [
                    { field: 'EQUIPMENT', label: 'Equipment No', resizable: false, width: 75 },
                    { field: 'BUILDING', label: 'Building', resizable: false, width: 75 },
                    { field: 'FLOOR', label: 'Floor', resizable: false, width: 50 },
                    { field: 'ASSET_NO', label: 'Door No', resizable: false, width: 50 },
                    { field: 'SORT_VAL', visible: false, get: function ( item ) {
                        return String( '0000' + item.feature.attributes.ASSET_NO ).slice( -4 );
                    } }
                ],
                sort: [
                    {
                        attribute: 'SORT_VAL',
                        descending: false
                    }
                ],
                customGridEventHandlers: [
                    {
                        event: 'dgrid-select',
                        handler: function ( event ) {
                            var result = event.rows;
                            console.log( result );
                        }
                    }
                ],
                selectionMode: 'single'
            }
        ],
        selectionSymbols: {
            polygon: {
                type: 'esriSFS',
                style: 'esriSFSSolid',
                color: [ 255, 0, 0, 62 ],
                outline: {
                    type: 'esriSLS',
                    style: 'esriSLSSolid',
                    color: [ 255, 0, 0, 255 ],
                    width: 3
                }
            },
            point: {
                type: 'esriSMS',
                style: 'esriSMSCircle',
                size: 25,
                color: [ 255, 0, 0, 62 ],
                angle: 0,
                xoffset: 0,
                yoffset: 0,
                outline: {
                    type: 'esriSLS',
                    style: 'esriSLSSolid',
                    color: [ 255, 0, 0, 255 ],
                    width: 2
                }
            }
        },
        selectionMode: 'extended'
    }
},
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>